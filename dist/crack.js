"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var X=require("bcryptjs"),f=require("crypto-js");function F(e){return f.SHA512(f.enc.Latin1.parse(e)).toString(f.enc.Latin1)}function Z(e){return f.SHA256(f.enc.Latin1.parse(e)).toString(f.enc.Latin1)}function Y(e,r){for(var t="",a=0;a<Math.floor(r/32);a++)t+=e;return t+=e.substr(0,r%32),t}function J(e,r){for(var t="",a=0;a<Math.floor(r/64);a++)t+=e;return t+=e.substr(0,r%64),t}function w(e,r){for(var t=F(e+r+e),a=e.length,l=J(t,e.length),n=e+r+l,i=a;i>0;i>>=1)i&1?n+=t:n+=e;var h=F(n);return h}function ee(e,r){for(var t=Z(e+r+e),a=e.length,l=Y(t,e.length),n=e+r+l,i=a;i>0;i>>=1)i&1?n+=t:n+=e;var h=Z(n);return h}function re(e,r,t){for(var a=ee(e,r),l="",n=0;n<e.length;n++)l+=e;for(var i=Z(l),h=Y(i,e.length),H="",n=0;n<16+a.charCodeAt(0);n++)H+=r;for(var A=Z(H),D=Y(A,r.length),p=a,c="",n=0;n<t;n++)c="",n&1?c+=h:c+=p,n%3&&(c+=D),n%7&&(c+=h),n&1?c+=p:c+=h,p=Z(c);return p}function te(e,r,t){for(var a=w(e,r),l="",n=0;n<e.length;n++)l+=e;for(var i=F(l),h=J(i,e.length),H="",n=0;n<16+a.charCodeAt(0);n++)H+=r;for(var A=F(H),D=J(A,r.length),p=a,c="",n=0;n<t;n++)c="",n&1?c+=h:c+=p,n%3&&(c+=D),n%7&&(c+=h),n&1?c+=p:c+=h,p=F(c);return p}function ne(e,r){var t="$6$",a,l=r.split("$");l.length>1&&(a=parseInt(l[2].split("=")[1]),a?(a<1e3&&(a=1e3),a>999999999&&(a=999999999),r=l[3]||r):r=l[2]||r),r=r.substr(0,16);var n="",i="";return n=te(e,r,a||5e3),i=_(n,0,21,42)+_(n,22,43,1)+_(n,44,2,23)+_(n,3,24,45)+_(n,25,46,4)+_(n,47,5,26)+_(n,6,27,48)+_(n,28,49,7)+_(n,50,8,29)+_(n,9,30,51)+_(n,31,52,10)+_(n,53,11,32)+_(n,12,33,54)+_(n,34,55,13)+_(n,56,14,35)+_(n,15,36,57)+_(n,37,58,16)+_(n,59,17,38)+_(n,18,39,60)+_(n,40,61,19)+_(n,62,20,41)+K(n,63),t+r+"$"+i}function ae(e,r){var t="$5$",a,l=r.split("$");l.length>1&&(a=parseInt(l[2].split("=")[1]),a?(a<1e3&&(a=1e3),a>999999999&&(a=999999999),r=l[3]||r):r=l[2]||r),r=r.substr(0,16);var n="",i="";n=re(e,r,a||5e3);var i=_(n,0,10,20)+_(n,21,1,11)+_(n,12,22,2)+_(n,3,13,23)+_(n,24,4,14)+_(n,15,25,5)+_(n,6,16,26)+_(n,27,7,17)+_(n,18,28,8)+_(n,9,19,29)+ie(n,31,30);return t+r+"$"+i}function O(e,r){const t="./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var a="";--r>=0;)a+=t.charAt(e&63),e>>=6;return a}function _(e,r,t,a){var l=e.charCodeAt(r)<<16|e.charCodeAt(t)<<8|e.charCodeAt(a);return O(l,4)}function ie(e,r,t){var a=e.charCodeAt(r)<<8|e.charCodeAt(t);return O(a,3)}function K(e,r){var t=e.charCodeAt(r);return O(t,2)}function ce(e,r){var t=e.length,a=e+"$1$"+r,l=e+r+e,n=f.MD5(l);for(t;t>0;t-=16)t>16?a=a.concat(n.toString(f.enc.Latin1)):a=a.concat(n.toString(f.enc.Latin1).substring(0,t));for(var i=e.length;i!=0;i>>=1)i%2==1?a+="\0":a+=e.charAt(0);var h=f.MD5(f.enc.Latin1.parse(a));for(i=0;i<1e3;i++){var H="";i&1?H+=e:H+=h.toString(f.enc.Latin1),i%3&&(H+=r),i%7&&(H+=e),i&1?H+=h.toString(f.enc.Latin1):H+=e,h=f.MD5(f.enc.Latin1.parse(H))}var A="$1$"+r+"$"+_(h.toString(f.enc.Latin1),0,6,12)+_(h.toString(f.enc.Latin1),1,7,13)+_(h.toString(f.enc.Latin1),2,8,14)+_(h.toString(f.enc.Latin1),3,9,15)+_(h.toString(f.enc.Latin1),4,10,5)+K(h.toString(f.enc.Latin1),11);return A}(function(e){var r=f,t=r.lib,a=t.WordArray,l=t.Hasher,n=r.algo,i=[[3,7,11,19],[3,5,9,13],[3,9,11,15]],h=0,H=1518500249,A=1859775393,D=n.MD4=l.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,y){for(var C=0;C<16;C++){var L=y+C,x=g[L];g[L]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360}var m=this._hash.words,T=g[y+0],b=g[y+1],M=g[y+2],V=g[y+3],B=g[y+4],U=g[y+5],P=g[y+6],q=g[y+7],j=g[y+8],E=g[y+9],G=g[y+10],R=g[y+11],k=g[y+12],I=g[y+13],N=g[y+14],W=g[y+15],o=m[0],u=m[1],v=m[2],s=m[3];o=c(S,h,o,u,v,s,T,i[0][0]),s=c(S,h,s,o,u,v,b,i[0][1]),v=c(S,h,v,s,o,u,M,i[0][2]),u=c(S,h,u,v,s,o,V,i[0][3]),o=c(S,h,o,u,v,s,B,i[0][0]),s=c(S,h,s,o,u,v,U,i[0][1]),v=c(S,h,v,s,o,u,P,i[0][2]),u=c(S,h,u,v,s,o,q,i[0][3]),o=c(S,h,o,u,v,s,j,i[0][0]),s=c(S,h,s,o,u,v,E,i[0][1]),v=c(S,h,v,s,o,u,G,i[0][2]),u=c(S,h,u,v,s,o,R,i[0][3]),o=c(S,h,o,u,v,s,k,i[0][0]),s=c(S,h,s,o,u,v,I,i[0][1]),v=c(S,h,v,s,o,u,N,i[0][2]),u=c(S,h,u,v,s,o,W,i[0][3]),o=c($,H,o,u,v,s,T,i[1][0]),s=c($,H,s,o,u,v,B,i[1][1]),v=c($,H,v,s,o,u,j,i[1][2]),u=c($,H,u,v,s,o,k,i[1][3]),o=c($,H,o,u,v,s,b,i[1][0]),s=c($,H,s,o,u,v,U,i[1][1]),v=c($,H,v,s,o,u,E,i[1][2]),u=c($,H,u,v,s,o,I,i[1][3]),o=c($,H,o,u,v,s,M,i[1][0]),s=c($,H,s,o,u,v,P,i[1][1]),v=c($,H,v,s,o,u,G,i[1][2]),u=c($,H,u,v,s,o,N,i[1][3]),o=c($,H,o,u,v,s,V,i[1][0]),s=c($,H,s,o,u,v,q,i[1][1]),v=c($,H,v,s,o,u,R,i[1][2]),u=c($,H,u,v,s,o,W,i[1][3]),o=c(d,A,o,u,v,s,T,i[2][0]),s=c(d,A,s,o,u,v,j,i[2][1]),v=c(d,A,v,s,o,u,B,i[2][2]),u=c(d,A,u,v,s,o,k,i[2][3]),o=c(d,A,o,u,v,s,M,i[2][0]),s=c(d,A,s,o,u,v,G,i[2][1]),v=c(d,A,v,s,o,u,P,i[2][2]),u=c(d,A,u,v,s,o,N,i[2][3]),o=c(d,A,o,u,v,s,b,i[2][0]),s=c(d,A,s,o,u,v,E,i[2][1]),v=c(d,A,v,s,o,u,U,i[2][2]),u=c(d,A,u,v,s,o,I,i[2][3]),o=c(d,A,o,u,v,s,V,i[2][0]),s=c(d,A,s,o,u,v,R,i[2][1]),v=c(d,A,v,s,o,u,q,i[2][2]),u=c(d,A,u,v,s,o,W,i[2][3]),m[0]=m[0]+o|0,m[1]=m[1]+u|0,m[2]=m[2]+v|0,m[3]=m[3]+s|0},_doFinalize:function(){var g=this._data,y=g.words,C=this._nDataBytes*8,L=g.sigBytes*8;y[L>>>5]|=128<<24-L%32;var x=e.floor(C/4294967296),m=C;y[(L+64>>>9<<4)+15]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,y[(L+64>>>9<<4)+14]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,g.sigBytes=(y.length+1)*4,this._process();for(var T=this._hash,b=T.words,M=0;M<4;M++){var V=b[M];b[M]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360}return T},clone:function(){var g=l.clone.call(this);return g._hash=this._hash.clone(),g}});function p(g,y){return g<<y|g>>>32-y}function c(g,y,C,L,x,m,T,b){return p(C+g(L,x,m)+T+y,b)}function S(g,y,C){return g&y|~g&C}function $(g,y,C){return g&y|g&C|y&C}function d(g,y,C){return g^y^C}r.MD4=l._createHelper(D),r.HmacMD4=l._createHmacHelper(D)})(Math);function fe(e){let r=1345345333,t=305419889,a=7;for(let n=0;n<e.length;n++){let i=e.charCodeAt(n);r^=((r&63)+a)*i+(r<<8),t+=t<<8^r,a+=i}let l=(r>>>0).toString(16)+(t>>>0).toString(16);for(;l.length<16;)l="0"+l;return l}function oe(e,r,t,a,l){let n=f.enc.Hex.parse(f.MD4(f.enc.Utf16LE.parse(l)).toString().toUpperCase());var i=f.enc.Utf16LE.parse(e.toUpperCase()+r),h=f.HmacMD5(i,n),H=f.HmacMD5(f.enc.Hex.parse(t+a),h);return f.enc.Hex.stringify(H)}function ue(e,r,t){switch(t){case"jwt":return _e(e,r);case"netntlmv2":return se(e,r);case"ntlm":return He(e,r);case"md5":return ye(e,r);case"sha1":return Ae(e,r);case"sha256":return me(e,r);case"sha512":return Se(e,r);case"bcrypt":return $e(e,r);case"md5crypt":return le(e,r);case"sha256crypt":return he(e,r);case"sha512crypt":return ge(e,r);case"hmac-md5":return de(e,r);case"hmac-sha1":return Ce(e,r);case"hmac-sha256":return pe(e,r);case"hmac-sha512":return xe(e,r);case"mysql323":return Le(e,r);default:throw new Error(`Unsupported hash type: ${t}`)}}function Q(e,r){switch(r){case"jwt":return/^([A-Za-z0-9-_]+={0,2})\.([A-Za-z0-9-_]+={0,2})\.([A-Za-z0-9-_]+={0,2})$/.test(e);case"netntlmv2":return/^[^:]+::[^:]+:[a-fA-F0-9]{16}:[a-fA-F0-9]{32,64}:[a-fA-F0-9]+$/.test(e);case"ntlm":return/^[a-fA-F0-9]{32}$/.test(e);case"md5":return/^[a-fA-F0-9]{32}$/.test(e);case"sha1":return/^[a-fA-F0-9]{40}$/.test(e);case"sha256":return/^[a-fA-F0-9]{64}$/.test(e);case"sha512":return/^[a-fA-F0-9]{128}$/.test(e);case"bcrypt":return/^\$2[aby]?\$[0-9]{2}\$[./A-Za-z0-9]{53}$/.test(e);case"md5crypt":return/^\$1\$[./A-Za-z0-9]{1,8}\$[./A-Za-z0-9]{22}$/.test(e);case"sha256crypt":return/^\$5\$(rounds=\d+\$)?[./A-Za-z0-9]{1,16}\$[./A-Za-z0-9]{43,86}$/.test(e);case"sha512crypt":return/^\$6\$(rounds=\d+\$)?[./A-Za-z0-9]{1,16}\$[./A-Za-z0-9]{86,}$/.test(e);case"mysql323":return/^[a-fA-F0-9]{16}$/.test(e);case"hmac-md5":return/^[a-fA-F0-9]{32}:[A-Za-z0-9_]+$/.test(e);case"hmac-sha1":return/^[a-fA-F0-9]{40}:[A-Za-z0-9_]+$/.test(e);case"hmac-sha256":return/^[a-fA-F0-9]{64}:[A-Za-z0-9_]+$/.test(e);case"hmac-sha512":return/^[a-fA-F0-9]{128}:[A-Za-z0-9_]+$/.test(e);default:throw new Error(`Unsupported hash type: ${r}`)}}function ve(e){let r=[];for(let t=0;t<z.length;t++)Q(e,z[t])&&r.push(z[t]);return r}function se(e,r){let t=r.split(":");if(t.length<6)return!1;var a=t[0],l=t[2],n=t[3],i=t[4],h=t[5],H=oe(a,l,n,h,e);return H===i}function le(e,r){return ce(e,r.split("$")[2])===r}function he(e,r){var t=r.split("$"),a,l,n;if(t.length>1)l=parseInt(t[2].split("=")[1]),l?(a=t[3],n=t[4]):(a=t[2],n=t[3]);else return!1;var i="$5$"+a+"$"+n;return ae(e,r)===i}function ge(e,r){var t=r.split("$"),a,l,n;if(t.length>1)a=parseInt(t[2].split("=")[1]),a?(l=t[3],n=t[4]):(l=t[2],n=t[3]);else return!1;var i="$6$"+l+"$"+n;return ne(e,r)===i}function _e(e,r){const t=r.split(".");var a=String(t[0])+"."+String(t[1]),l=f.HmacSHA256(String(a),String(e)).toString(f.enc.Base64).replaceAll("=","").replaceAll("+","-").replaceAll("/","_");return t[2]==l}function He(e,r){return f.MD4(f.enc.Utf16LE.parse(e)).toString().toUpperCase()===r.toString().toUpperCase()}function ye(e,r){return f.MD5(e).toString(f.enc.Hex)===r.toLowerCase()}function Ae(e,r){return f.SHA1(e).toString(f.enc.Hex)===r.toLowerCase()}function me(e,r){return f.SHA256(e).toString(f.enc.Hex)===r.toLowerCase()}function Se(e,r){return f.SHA512(e).toString(f.enc.Hex)===r.toLowerCase()}function $e(e,r){return X.compareSync(e,r)}function de(e,r){const t=r.split(":");let a=null;return t.length==2?(a=f.HmacMD5(e,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()):(a=f.HmacMD5(e,e).toString(f.enc.Hex),a===r.toLowerCase())}function Ce(e,r){const t=r.split(":");let a=null;return t.length==2?(a=f.HmacSHA1(e,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()||(a=f.HmacSHA1(t[1],e).toString(f.enc.Hex),a===t[0].toLowerCase())):(a=f.HmacSHA1(e,e).toString(f.enc.Hex),a===r.toLowerCase())}function pe(e,r){const t=r.split(":");let a=null;return t.length==2?(a=f.HmacSHA256(e,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()||(a=f.HmacSHA256(t[1],e).toString(f.enc.Hex),a===t[0].toLowerCase())):(a=f.HmacSHA256(e,e).toString(f.enc.Hex),a===r.toLowerCase())}function xe(e,r){const t=r.split(":");let a=null;return t.length==2?(a=f.HmacSHA512(e,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()||(a=f.HmacSHA512(t[1],e).toString(f.enc.Hex),a===t[0].toLowerCase())):(a=f.HmacSHA512(e,e).toString(f.enc.Hex),a===r.toLowerCase())}function Le(e,r){return fe(e).toLowerCase()===r.toLowerCase()}const z=["md5crypt","sha256crypt","sha512crypt","ntlm","md5","sha1","sha256","sha512","bcrypt","netntlmv2","hmac-md5","hmac-sha1","hmac-sha256","hmac-sha512","mysql323","jwt"];exports.availableHashTypes=z;exports.getPossibleHashTypes=ve;exports.isValidHash=Q;exports.verifyHash=ue;
