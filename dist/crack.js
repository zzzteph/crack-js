"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var X=require("bcryptjs"),f=require("crypto-js");function B(r){return f.SHA512(f.enc.Latin1.parse(r)).toString(f.enc.Latin1)}function U(r){return f.SHA256(f.enc.Latin1.parse(r)).toString(f.enc.Latin1)}function J(r,e){for(var t="",a=0;a<Math.floor(e/32);a++)t+=r;return t+=r.substr(0,e%32),t}function O(r,e){for(var t="",a=0;a<Math.floor(e/64);a++)t+=r;return t+=r.substr(0,e%64),t}function Z(r,e){for(var t=B(r+e+r),a=r.length,h=O(t,r.length),n=r+e+h,i=a;i>0;i>>=1)i&1?n+=t:n+=r;var s=B(n);return s}function z(r,e){for(var t=U(r+e+r),a=r.length,h=J(t,r.length),n=r+e+h,i=a;i>0;i>>=1)i&1?n+=t:n+=r;var s=U(n);return s}function w(r,e,t){for(var a=z(r,e),h="",n=0;n<r.length;n++)h+=r;for(var i=U(h),s=J(i,r.length),H="",n=0;n<16+a.charCodeAt(0);n++)H+=e;for(var S=U(H),D=J(S,e.length),d=a,c="",n=0;n<t;n++)c="",n&1?c+=s:c+=d,n%3&&(c+=D),n%7&&(c+=s),n&1?c+=d:c+=s,d=U(c);return d}function rr(r,e,t){for(var a=Z(r,e),h="",n=0;n<r.length;n++)h+=r;for(var i=B(h),s=O(i,r.length),H="",n=0;n<16+a.charCodeAt(0);n++)H+=e;for(var S=B(H),D=O(S,e.length),d=a,c="",n=0;n<t;n++)c="",n&1?c+=s:c+=d,n%3&&(c+=D),n%7&&(c+=s),n&1?c+=d:c+=s,d=B(c);return d}function er(r,e){var t="$6$",a,h=e.split("$");h.length>1&&(a=parseInt(h[2].split("=")[1]),a?(a<1e3&&(a=1e3),a>999999999&&(a=999999999),e=h[3]||e):e=h[2]||e),e=e.substr(0,16);var n="",i="";return n=rr(r,e,a||5e3),i=_(n,0,21,42)+_(n,22,43,1)+_(n,44,2,23)+_(n,3,24,45)+_(n,25,46,4)+_(n,47,5,26)+_(n,6,27,48)+_(n,28,49,7)+_(n,50,8,29)+_(n,9,30,51)+_(n,31,52,10)+_(n,53,11,32)+_(n,12,33,54)+_(n,34,55,13)+_(n,56,14,35)+_(n,15,36,57)+_(n,37,58,16)+_(n,59,17,38)+_(n,18,39,60)+_(n,40,61,19)+_(n,62,20,41)+Q(n,63),t+e+"$"+i}function tr(r,e){var t="$5$",a,h=e.split("$");h.length>1&&(a=parseInt(h[2].split("=")[1]),a?(a<1e3&&(a=1e3),a>999999999&&(a=999999999),e=h[3]||e):e=h[2]||e),e=e.substr(0,16);var n="",i="";n=w(r,e,a||5e3);var i=_(n,0,10,20)+_(n,21,1,11)+_(n,12,22,2)+_(n,3,13,23)+_(n,24,4,14)+_(n,15,25,5)+_(n,6,16,26)+_(n,27,7,17)+_(n,18,28,8)+_(n,9,19,29)+nr(n,31,30);return t+e+"$"+i}function K(r,e){const t="./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var a="";--e>=0;)a+=t.charAt(r&63),r>>=6;return a}function _(r,e,t,a){var h=r.charCodeAt(e)<<16|r.charCodeAt(t)<<8|r.charCodeAt(a);return K(h,4)}function nr(r,e,t){var a=r.charCodeAt(e)<<8|r.charCodeAt(t);return K(a,3)}function Q(r,e){var t=r.charCodeAt(e);return K(t,2)}function ar(r,e){var t=r.length,a=r+"$1$"+e,h=r+e+r,n=f.MD5(h);for(t;t>0;t-=16)t>16?a=a.concat(n.toString(f.enc.Latin1)):a=a.concat(n.toString(f.enc.Latin1).substring(0,t));for(var i=r.length;i!=0;i>>=1)i%2==1?a+="\0":a+=r.charAt(0);var s=f.MD5(f.enc.Latin1.parse(a));for(i=0;i<1e3;i++){var H="";i&1?H+=r:H+=s.toString(f.enc.Latin1),i%3&&(H+=e),i%7&&(H+=r),i&1?H+=s.toString(f.enc.Latin1):H+=r,s=f.MD5(f.enc.Latin1.parse(H))}var S="$1$"+e+"$"+_(s.toString(f.enc.Latin1),0,6,12)+_(s.toString(f.enc.Latin1),1,7,13)+_(s.toString(f.enc.Latin1),2,8,14)+_(s.toString(f.enc.Latin1),3,9,15)+_(s.toString(f.enc.Latin1),4,10,5)+Q(s.toString(f.enc.Latin1),11);return S}(function(r){var e=f,t=e.lib,a=t.WordArray,h=t.Hasher,n=e.algo,i=[[3,7,11,19],[3,5,9,13],[3,9,11,15]],s=0,H=1518500249,S=1859775393,D=n.MD4=h.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,y){for(var L=0;L<16;L++){var p=y+L,T=g[p];g[p]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}var m=this._hash.words,b=g[y+0],M=g[y+1],$=g[y+2],V=g[y+3],q=g[y+4],F=g[y+5],P=g[y+6],G=g[y+7],R=g[y+8],k=g[y+9],E=g[y+10],I=g[y+11],N=g[y+12],W=g[y+13],j=g[y+14],Y=g[y+15],o=m[0],v=m[1],u=m[2],l=m[3];o=c(C,s,o,v,u,l,b,i[0][0]),l=c(C,s,l,o,v,u,M,i[0][1]),u=c(C,s,u,l,o,v,$,i[0][2]),v=c(C,s,v,u,l,o,V,i[0][3]),o=c(C,s,o,v,u,l,q,i[0][0]),l=c(C,s,l,o,v,u,F,i[0][1]),u=c(C,s,u,l,o,v,P,i[0][2]),v=c(C,s,v,u,l,o,G,i[0][3]),o=c(C,s,o,v,u,l,R,i[0][0]),l=c(C,s,l,o,v,u,k,i[0][1]),u=c(C,s,u,l,o,v,E,i[0][2]),v=c(C,s,v,u,l,o,I,i[0][3]),o=c(C,s,o,v,u,l,N,i[0][0]),l=c(C,s,l,o,v,u,W,i[0][1]),u=c(C,s,u,l,o,v,j,i[0][2]),v=c(C,s,v,u,l,o,Y,i[0][3]),o=c(A,H,o,v,u,l,b,i[1][0]),l=c(A,H,l,o,v,u,q,i[1][1]),u=c(A,H,u,l,o,v,R,i[1][2]),v=c(A,H,v,u,l,o,N,i[1][3]),o=c(A,H,o,v,u,l,M,i[1][0]),l=c(A,H,l,o,v,u,F,i[1][1]),u=c(A,H,u,l,o,v,k,i[1][2]),v=c(A,H,v,u,l,o,W,i[1][3]),o=c(A,H,o,v,u,l,$,i[1][0]),l=c(A,H,l,o,v,u,P,i[1][1]),u=c(A,H,u,l,o,v,E,i[1][2]),v=c(A,H,v,u,l,o,j,i[1][3]),o=c(A,H,o,v,u,l,V,i[1][0]),l=c(A,H,l,o,v,u,G,i[1][1]),u=c(A,H,u,l,o,v,I,i[1][2]),v=c(A,H,v,u,l,o,Y,i[1][3]),o=c(x,S,o,v,u,l,b,i[2][0]),l=c(x,S,l,o,v,u,R,i[2][1]),u=c(x,S,u,l,o,v,q,i[2][2]),v=c(x,S,v,u,l,o,N,i[2][3]),o=c(x,S,o,v,u,l,$,i[2][0]),l=c(x,S,l,o,v,u,E,i[2][1]),u=c(x,S,u,l,o,v,P,i[2][2]),v=c(x,S,v,u,l,o,j,i[2][3]),o=c(x,S,o,v,u,l,M,i[2][0]),l=c(x,S,l,o,v,u,k,i[2][1]),u=c(x,S,u,l,o,v,F,i[2][2]),v=c(x,S,v,u,l,o,W,i[2][3]),o=c(x,S,o,v,u,l,V,i[2][0]),l=c(x,S,l,o,v,u,I,i[2][1]),u=c(x,S,u,l,o,v,G,i[2][2]),v=c(x,S,v,u,l,o,Y,i[2][3]),m[0]=m[0]+o|0,m[1]=m[1]+v|0,m[2]=m[2]+u|0,m[3]=m[3]+l|0},_doFinalize:function(){var g=this._data,y=g.words,L=this._nDataBytes*8,p=g.sigBytes*8;y[p>>>5]|=128<<24-p%32;var T=r.floor(L/4294967296),m=L;y[(p+64>>>9<<4)+15]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,y[(p+64>>>9<<4)+14]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,g.sigBytes=(y.length+1)*4,this._process();for(var b=this._hash,M=b.words,$=0;$<4;$++){var V=M[$];M[$]=(V<<8|V>>>24)&16711935|(V<<24|V>>>8)&4278255360}return b},clone:function(){var g=h.clone.call(this);return g._hash=this._hash.clone(),g}});function d(g,y){return g<<y|g>>>32-y}function c(g,y,L,p,T,m,b,M){return d(L+g(p,T,m)+b+y,M)}function C(g,y,L){return g&y|~g&L}function A(g,y,L){return g&y|g&L|y&L}function x(g,y,L){return g^y^L}e.MD4=h._createHelper(D),e.HmacMD4=h._createHmacHelper(D)})(Math);function ir(r){let e=1345345333,t=305419889,a=7;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);e^=((e&63)+a)*i+(e<<8),t+=t<<8^e,a+=i}let h=(e>>>0).toString(16)+(t>>>0).toString(16);for(;h.length<16;)h="0"+h;return h}function cr(r,e,t,a,h){let n=f.enc.Hex.parse(f.MD4(f.enc.Utf16LE.parse(h)).toString().toUpperCase());var i=f.enc.Utf16LE.parse(r.toUpperCase()+e),s=f.HmacMD5(i,n),H=f.HmacMD5(f.enc.Hex.parse(t+a),s);return f.enc.Hex.stringify(H)}function fr(r,e,t){switch(t){case"jwt":return hr(r,e);case"netntlmv2":return or(r,e);case"ntlm":return sr(r,e);case"md5":return gr(r,e);case"sha1":return _r(r,e);case"sha256":return Hr(r,e);case"sha512":return yr(r,e);case"bcrypt":return Sr(r,e);case"md5crypt":return vr(r,e);case"sha256crypt":return ur(r,e);case"sha512crypt":return lr(r,e);case"hmac-md5":return mr(r,e);case"hmac-sha1":return Cr(r,e);case"hmac-sha256":return Ar(r,e);case"hmac-sha512":return xr(r,e);case"mysql323":return Lr(r,e);default:throw new Error(`Unsupported hash type: ${t}`)}}function or(r,e){let t=e.split(":");if(t.length<6)return!1;var a=t[0],h=t[2],n=t[3],i=t[4],s=t[5],H=cr(a,h,n,s,r);return H===i}function vr(r,e){return ar(r,e.split("$")[2])===e}function ur(r,e){var t=e.split("$"),a,h,n;if(t.length>1)h=parseInt(t[2].split("=")[1]),h?(a=t[3],n=t[4]):(a=t[2],n=t[3]);else return!1;var i="$5$"+a+"$"+n;return tr(r,e)===i}function lr(r,e){var t=e.split("$"),a,h,n;if(t.length>1)a=parseInt(t[2].split("=")[1]),a?(h=t[3],n=t[4]):(h=t[2],n=t[3]);else return!1;var i="$6$"+h+"$"+n;return er(r,e)===i}function hr(r,e){const t=e.split(".");var a=String(t[0])+"."+String(t[1]),h=f.HmacSHA256(String(a),String(r)).toString(f.enc.Base64).replaceAll("=","").replaceAll("+","-").replaceAll("/","_");return t[2]==h}function sr(r,e){return f.MD4(f.enc.Utf16LE.parse(r)).toString().toUpperCase()===e.toString().toUpperCase()}function gr(r,e){return f.MD5(r).toString(f.enc.Hex)===e.toLowerCase()}function _r(r,e){return f.SHA1(r).toString(f.enc.Hex)===e.toLowerCase()}function Hr(r,e){return f.SHA256(r).toString(f.enc.Hex)===e.toLowerCase()}function yr(r,e){return f.SHA512(r).toString(f.enc.Hex)===e.toLowerCase()}function Sr(r,e){return X.compareSync(r,e)}function mr(r,e){const t=e.split(":");let a=null;return t.length==2?(a=f.HmacMD5(r,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()):(a=f.HmacMD5(r,r).toString(f.enc.Hex),a===e.toLowerCase())}function Cr(r,e){const t=e.split(":");let a=null;return t.length==2?(a=f.HmacSHA1(r,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()||(a=f.HmacSHA1(t[1],r).toString(f.enc.Hex),a===t[0].toLowerCase())):(a=f.HmacSHA1(r,r).toString(f.enc.Hex),a===e.toLowerCase())}function Ar(r,e){const t=e.split(":");let a=null;return t.length==2?(a=f.HmacSHA256(r,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()||(a=f.HmacSHA256(t[1],r).toString(f.enc.Hex),a===t[0].toLowerCase())):(a=f.HmacSHA256(r,r).toString(f.enc.Hex),a===e.toLowerCase())}function xr(r,e){const t=e.split(":");let a=null;return t.length==2?(a=f.HmacSHA512(r,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()||(a=f.HmacSHA512(t[1],r).toString(f.enc.Hex),a===t[0].toLowerCase())):(a=f.HmacSHA512(r,r).toString(f.enc.Hex),a===e.toLowerCase())}function Lr(r,e){return ir(r).toLowerCase()===e.toLowerCase()}const dr=["md5crypt","sha256crypt","sha512crypt","ntlm","md5","sha1","sha256","sha512","bcrypt","netntlmv2","hmac-md5","hmac-sha1","hmac-sha256","hmac-sha512","mysql323"];exports.availableHashTypes=dr;exports.verifyHash=fr;
