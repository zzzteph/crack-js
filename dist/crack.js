"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});var w=require("bcryptjs"),f=require("crypto-js");function F(e){return f.SHA512(f.enc.Latin1.parse(e)).toString(f.enc.Latin1)}function V(e){return f.SHA256(f.enc.Latin1.parse(e)).toString(f.enc.Latin1)}function K(e,r){for(var t="",a=0;a<Math.floor(r/32);a++)t+=e;return t+=e.substr(0,r%32),t}function R(e,r){for(var t="",a=0;a<Math.floor(r/64);a++)t+=e;return t+=e.substr(0,r%64),t}function ee(e,r){for(var t=F(e+r+e),a=e.length,l=R(t,e.length),n=e+r+l,c=a;c>0;c>>=1)c&1?n+=t:n+=e;var h=F(n);return h}function re(e,r){for(var t=V(e+r+e),a=e.length,l=K(t,e.length),n=e+r+l,c=a;c>0;c>>=1)c&1?n+=t:n+=e;var h=V(n);return h}function te(e,r,t){for(var a=re(e,r),l="",n=0;n<e.length;n++)l+=e;for(var c=V(l),h=K(c,e.length),b="",n=0;n<16+a.charCodeAt(0);n++)b+=r;for(var _=V(b),M=K(_,r.length),p=a,i="",n=0;n<t;n++)i="",n&1?i+=h:i+=p,n%3&&(i+=M),n%7&&(i+=h),n&1?i+=p:i+=h,p=V(i);return p}function ae(e,r,t){for(var a=ee(e,r),l="",n=0;n<e.length;n++)l+=e;for(var c=F(l),h=R(c,e.length),b="",n=0;n<16+a.charCodeAt(0);n++)b+=r;for(var _=F(b),M=R(_,r.length),p=a,i="",n=0;n<t;n++)i="",n&1?i+=h:i+=p,n%3&&(i+=M),n%7&&(i+=h),n&1?i+=p:i+=h,p=F(i);return p}function ne(e,r){var t="$6$",a,l=r.split("$");l.length>1&&(a=parseInt(l[2].split("=")[1]),a?(a<1e3&&(a=1e3),a>999999999&&(a=999999999),r=l[3]||r):r=l[2]||r),r=r.substr(0,16);var n="",c="";return n=ae(e,r,a||5e3),c=g(n,0,21,42)+g(n,22,43,1)+g(n,44,2,23)+g(n,3,24,45)+g(n,25,46,4)+g(n,47,5,26)+g(n,6,27,48)+g(n,28,49,7)+g(n,50,8,29)+g(n,9,30,51)+g(n,31,52,10)+g(n,53,11,32)+g(n,12,33,54)+g(n,34,55,13)+g(n,56,14,35)+g(n,15,36,57)+g(n,37,58,16)+g(n,59,17,38)+g(n,18,39,60)+g(n,40,61,19)+g(n,62,20,41)+Y(n,63),t+r+"$"+c}function ce(e,r){var t="$5$",a,l=r.split("$");l.length>1&&(a=parseInt(l[2].split("=")[1]),a?(a<1e3&&(a=1e3),a>999999999&&(a=999999999),r=l[3]||r):r=l[2]||r),r=r.substr(0,16);var n="",c="";n=te(e,r,a||5e3);var c=g(n,0,10,20)+g(n,21,1,11)+g(n,12,22,2)+g(n,3,13,23)+g(n,24,4,14)+g(n,15,25,5)+g(n,6,16,26)+g(n,27,7,17)+g(n,18,28,8)+g(n,9,19,29)+ie(n,31,30);return t+r+"$"+c}function W(e,r){const t="./0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var a="";--r>=0;)a+=t.charAt(e&63),e>>=6;return a}function g(e,r,t,a){var l=e.charCodeAt(r)<<16|e.charCodeAt(t)<<8|e.charCodeAt(a);return W(l,4)}function ie(e,r,t){var a=e.charCodeAt(r)<<8|e.charCodeAt(t);return W(a,3)}function Y(e,r){var t=e.charCodeAt(r);return W(t,2)}function fe(e,r){var t=e.length,a=e+"$1$"+r,l=e+r+e,n=f.MD5(l);for(t;t>0;t-=16)t>16?a=a.concat(n.toString(f.enc.Latin1)):a=a.concat(n.toString(f.enc.Latin1).substring(0,t));for(var c=e.length;c!=0;c>>=1)c%2==1?a+="\0":a+=e.charAt(0);var h=f.MD5(f.enc.Latin1.parse(a));for(c=0;c<1e3;c++){var b="";c&1?b+=e:b+=h.toString(f.enc.Latin1),c%3&&(b+=r),c%7&&(b+=e),c&1?b+=h.toString(f.enc.Latin1):b+=e,h=f.MD5(f.enc.Latin1.parse(b))}var _="$1$"+r+"$"+g(h.toString(f.enc.Latin1),0,6,12)+g(h.toString(f.enc.Latin1),1,7,13)+g(h.toString(f.enc.Latin1),2,8,14)+g(h.toString(f.enc.Latin1),3,9,15)+g(h.toString(f.enc.Latin1),4,10,5)+Y(h.toString(f.enc.Latin1),11);return _}(function(e){var r=f,t=r.lib,a=t.WordArray,l=t.Hasher,n=r.algo,c=[[3,7,11,19],[3,5,9,13],[3,9,11,15]],h=0,b=1518500249,_=1859775393,M=n.MD4=l.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,y){for(var $=0;$<16;$++){var C=y+$,L=d[C];d[C]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360}var H=this._hash.words,x=d[y+0],T=d[y+1],k=d[y+2],D=d[y+3],Z=d[y+4],U=d[y+5],E=d[y+6],N=d[y+7],B=d[y+8],q=d[y+9],J=d[y+10],P=d[y+11],j=d[y+12],G=d[y+13],I=d[y+14],O=d[y+15],o=H[0],u=H[1],s=H[2],v=H[3];o=i(m,h,o,u,s,v,x,c[0][0]),v=i(m,h,v,o,u,s,T,c[0][1]),s=i(m,h,s,v,o,u,k,c[0][2]),u=i(m,h,u,s,v,o,D,c[0][3]),o=i(m,h,o,u,s,v,Z,c[0][0]),v=i(m,h,v,o,u,s,U,c[0][1]),s=i(m,h,s,v,o,u,E,c[0][2]),u=i(m,h,u,s,v,o,N,c[0][3]),o=i(m,h,o,u,s,v,B,c[0][0]),v=i(m,h,v,o,u,s,q,c[0][1]),s=i(m,h,s,v,o,u,J,c[0][2]),u=i(m,h,u,s,v,o,P,c[0][3]),o=i(m,h,o,u,s,v,j,c[0][0]),v=i(m,h,v,o,u,s,G,c[0][1]),s=i(m,h,s,v,o,u,I,c[0][2]),u=i(m,h,u,s,v,o,O,c[0][3]),o=i(A,b,o,u,s,v,x,c[1][0]),v=i(A,b,v,o,u,s,Z,c[1][1]),s=i(A,b,s,v,o,u,B,c[1][2]),u=i(A,b,u,s,v,o,j,c[1][3]),o=i(A,b,o,u,s,v,T,c[1][0]),v=i(A,b,v,o,u,s,U,c[1][1]),s=i(A,b,s,v,o,u,q,c[1][2]),u=i(A,b,u,s,v,o,G,c[1][3]),o=i(A,b,o,u,s,v,k,c[1][0]),v=i(A,b,v,o,u,s,E,c[1][1]),s=i(A,b,s,v,o,u,J,c[1][2]),u=i(A,b,u,s,v,o,I,c[1][3]),o=i(A,b,o,u,s,v,D,c[1][0]),v=i(A,b,v,o,u,s,N,c[1][1]),s=i(A,b,s,v,o,u,P,c[1][2]),u=i(A,b,u,s,v,o,O,c[1][3]),o=i(S,_,o,u,s,v,x,c[2][0]),v=i(S,_,v,o,u,s,B,c[2][1]),s=i(S,_,s,v,o,u,Z,c[2][2]),u=i(S,_,u,s,v,o,j,c[2][3]),o=i(S,_,o,u,s,v,k,c[2][0]),v=i(S,_,v,o,u,s,J,c[2][1]),s=i(S,_,s,v,o,u,E,c[2][2]),u=i(S,_,u,s,v,o,I,c[2][3]),o=i(S,_,o,u,s,v,T,c[2][0]),v=i(S,_,v,o,u,s,q,c[2][1]),s=i(S,_,s,v,o,u,U,c[2][2]),u=i(S,_,u,s,v,o,G,c[2][3]),o=i(S,_,o,u,s,v,D,c[2][0]),v=i(S,_,v,o,u,s,P,c[2][1]),s=i(S,_,s,v,o,u,N,c[2][2]),u=i(S,_,u,s,v,o,O,c[2][3]),H[0]=H[0]+o|0,H[1]=H[1]+u|0,H[2]=H[2]+s|0,H[3]=H[3]+v|0},_doFinalize:function(){var d=this._data,y=d.words,$=this._nDataBytes*8,C=d.sigBytes*8;y[C>>>5]|=128<<24-C%32;var L=e.floor($/4294967296),H=$;y[(C+64>>>9<<4)+15]=(L<<8|L>>>24)&16711935|(L<<24|L>>>8)&4278255360,y[(C+64>>>9<<4)+14]=(H<<8|H>>>24)&16711935|(H<<24|H>>>8)&4278255360,d.sigBytes=(y.length+1)*4,this._process();for(var x=this._hash,T=x.words,k=0;k<4;k++){var D=T[k];T[k]=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360}return x},clone:function(){var d=l.clone.call(this);return d._hash=this._hash.clone(),d}});function p(d,y){return d<<y|d>>>32-y}function i(d,y,$,C,L,H,x,T){return p($+d(C,L,H)+x+y,T)}function m(d,y,$){return d&y|~d&$}function A(d,y,$){return d&y|d&$|y&$}function S(d,y,$){return d^y^$}r.MD4=l._createHelper(M),r.HmacMD4=l._createHmacHelper(M)})(Math);function oe(e){let r=1345345333,t=305419889,a=7;for(let n=0;n<e.length;n++){let c=e.charCodeAt(n);r^=((r&63)+a)*c+(r<<8),t+=t<<8^r,a+=c}let l=(r>>>0).toString(16)+(t>>>0).toString(16);for(;l.length<16;)l="0"+l;return l}function ue(e,r,t,a,l){let n=f.enc.Hex.parse(f.MD4(f.enc.Utf16LE.parse(l)).toString().toUpperCase());var c=f.enc.Utf16LE.parse(e.toUpperCase()+r),h=f.HmacMD5(c,n),b=f.HmacMD5(f.enc.Hex.parse(t+a),h);return f.enc.Hex.stringify(b)}function X(e,r,t){switch(t){case"jwt":return be(e,r);case"netntlmv2":return le(e,r);case"ntlm":return ye(e,r);case"md5":return _e(e,r);case"sha1":return He(e,r);case"sha256":return me(e,r);case"sha512":return Ae(e,r);case"bcrypt":return Se(e,r);case"md5crypt":return he(e,r);case"sha256crypt":return de(e,r);case"sha512crypt":return ge(e,r);case"hmac-md5":return $e(e,r);case"hmac-sha1":return pe(e,r);case"hmac-sha256":return Le(e,r);case"hmac-sha512":return Ce(e,r);case"mysql323":return xe(e,r);default:throw new Error(`Unsupported hash type: ${t}`)}}function se(e){let r=!1;switch(e){case"jwt":r="eyJhbGciOiJIUzI1NiJ9.eyIzNDM2MzQyMCI6NTc2ODc1NDd9.f1nXZ3V_Hrr6ee-AFCTLaHRnrkiKmio2t3JqwL32guY";break;case"netntlmv2":r="admin::N46iSNekpT:08ca45b7d7ea58ee:88dcbe4446168966a153a0064958dac6:5c7830315c7830310000000000000b45c67103d07d7b95acd12ffa11230e0000000052920b85f78d013c31cdb3b92f5d765c783030";break;case"ntlm":r="b4b9b02e6f09a9bd760f388b67351e2b";break;case"md5":r="8743b52063cd84097a65d1633f5c74f5";break;case"sha1":r="b89eaac7e61417341b710b727768294d0e6a277b";break;case"sha256":r="127e6fbfe24a750e72930c220a8e138275656b8e5d8f48a98c3c92df2caba935";break;case"sha512":r="82a9dda829eb7f8ffe9fbe49e45d47d2dad9664fbb7adf72492e3c81ebd3e29134d9bc12212bf83c6840f10e8246b9db54a4859b7ccd0123d86e5872c1e5082f";break;case"bcrypt":r="$2a$05$LhayLxezLhK1LhWvKxCyLOj0j1u.Kj0jZ0pEmm134uzrQlFvQJLF6";break;case"md5crypt":r="$1$28772684$iEwNOgGugqO9.bIz5sk8k/";break;case"sha256crypt":r="$5$rounds=5000$GX7BopJZJxPc/KEK$le16UF8I2Anb.rOrn22AUPWvzUETDGefUmAV8AZkGcD";break;case"sha512crypt":r="$6$52450745$k5ka2p8bFuSmoVT1tzOyyuaREkkKBcCNqoDKzYiJL9RaE8yMnPgh2XzzF0NDrUhgrcLwg78xs1w5pJiypEdFX/";break;case"mysql323":r="7196759210defdc0";break;case"hmac-md5":r="bfd280436f45fa38eaacac3b00518f29:1234";break;case"hmac-sha1":r="d89c92b4400b15c39e462a8caa939ab40c3aeeea:1234";break;case"hmac-sha256":r="8efbef4cec28f228fa948daaf4893ac3638fbae81358ff9020be1d7a9a509fc6:1234";break;case"hmac-sha512":r="7cce966f5503e292a51381f238d071971ad5442488f340f98e379b3aeae2f33778e3e732fcc2f7bdc04f3d460eebf6f8cb77da32df25500c09160dd3bf7d2a6b:1234";break;default:throw new Error(`Unsupported hash type: ${e}`)}const t=5e3,a=Date.now();let l=0;for(;Date.now()-a<t;)X("hashcat",r,e),l++;return Math.floor(l/(t/1e3))}function Q(e,r){switch(r){case"jwt":return/^([A-Za-z0-9-_]+={0,2})\.([A-Za-z0-9-_]+={0,2})\.([A-Za-z0-9-_]+={0,2})$/.test(e);case"netntlmv2":return/^[^:]+::[^:]+:[a-fA-F0-9]{16}:[a-fA-F0-9]{32,64}:[a-fA-F0-9]+$/.test(e);case"ntlm":return/^[a-fA-F0-9]{32}$/.test(e);case"md5":return/^[a-fA-F0-9]{32}$/.test(e);case"sha1":return/^[a-fA-F0-9]{40}$/.test(e);case"sha256":return/^[a-fA-F0-9]{64}$/.test(e);case"sha512":return/^[a-fA-F0-9]{128}$/.test(e);case"bcrypt":return/^\$2[aby]?\$[0-9]{2}\$[./A-Za-z0-9]{53}$/.test(e);case"md5crypt":return/^\$1\$[./A-Za-z0-9]{1,8}\$[./A-Za-z0-9]{22}$/.test(e);case"sha256crypt":return/^\$5\$(rounds=\d+\$)?[./A-Za-z0-9]{1,16}\$[./A-Za-z0-9]{43,86}$/.test(e);case"sha512crypt":return/^\$6\$(rounds=\d+\$)?[./A-Za-z0-9]{1,16}\$[./A-Za-z0-9]{86,}$/.test(e);case"mysql323":return/^[a-fA-F0-9]{16}$/.test(e);case"hmac-md5":return/^[a-fA-F0-9]{32}:[A-Za-z0-9_]+$/.test(e);case"hmac-sha1":return/^[a-fA-F0-9]{40}:[A-Za-z0-9_]+$/.test(e);case"hmac-sha256":return/^[a-fA-F0-9]{64}:[A-Za-z0-9_]+$/.test(e);case"hmac-sha512":return/^[a-fA-F0-9]{128}:[A-Za-z0-9_]+$/.test(e);default:throw new Error(`Unsupported hash type: ${r}`)}}function ve(e){let r=[];for(let t=0;t<z.length;t++)Q(e,z[t])&&r.push(z[t]);return r}function le(e,r){let t=r.split(":");if(t.length<6)return!1;var a=t[0],l=t[2],n=t[3],c=t[4],h=t[5],b=ue(a,l,n,h,e);return b===c}function he(e,r){return fe(e,r.split("$")[2])===r}function de(e,r){var t=r.split("$"),a,l,n;if(t.length>1)l=parseInt(t[2].split("=")[1]),l?(a=t[3],n=t[4]):(a=t[2],n=t[3]);else return!1;var c="$5$"+a+"$"+n;return ce(e,r)===c}function ge(e,r){var t=r.split("$"),a,l,n;if(t.length>1)a=parseInt(t[2].split("=")[1]),a?(l=t[3],n=t[4]):(l=t[2],n=t[3]);else return!1;var c="$6$"+l+"$"+n;return ne(e,r)===c}function be(e,r){const t=r.split(".");var a=String(t[0])+"."+String(t[1]),l=f.HmacSHA256(String(a),String(e)).toString(f.enc.Base64).replaceAll("=","").replaceAll("+","-").replaceAll("/","_");return t[2]==l}function ye(e,r){return f.MD4(f.enc.Utf16LE.parse(e)).toString().toUpperCase()===r.toString().toUpperCase()}function _e(e,r){return f.MD5(e).toString(f.enc.Hex)===r.toLowerCase()}function He(e,r){return f.SHA1(e).toString(f.enc.Hex)===r.toLowerCase()}function me(e,r){return f.SHA256(e).toString(f.enc.Hex)===r.toLowerCase()}function Ae(e,r){return f.SHA512(e).toString(f.enc.Hex)===r.toLowerCase()}function Se(e,r){return w.compareSync(e,r)}function $e(e,r){const t=r.split(":");let a=null;return t.length==2?(a=f.HmacMD5(e,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()):(a=f.HmacMD5(e,e).toString(f.enc.Hex),a===r.toLowerCase())}function pe(e,r){const t=r.split(":");let a=null;return t.length==2?(a=f.HmacSHA1(e,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()||(a=f.HmacSHA1(t[1],e).toString(f.enc.Hex),a===t[0].toLowerCase())):(a=f.HmacSHA1(e,e).toString(f.enc.Hex),a===r.toLowerCase())}function Le(e,r){const t=r.split(":");let a=null;return t.length==2?(a=f.HmacSHA256(e,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()||(a=f.HmacSHA256(t[1],e).toString(f.enc.Hex),a===t[0].toLowerCase())):(a=f.HmacSHA256(e,e).toString(f.enc.Hex),a===r.toLowerCase())}function Ce(e,r){const t=r.split(":");let a=null;return t.length==2?(a=f.HmacSHA512(e,t[1]).toString(f.enc.Hex),a===t[0].toLowerCase()||(a=f.HmacSHA512(t[1],e).toString(f.enc.Hex),a===t[0].toLowerCase())):(a=f.HmacSHA512(e,e).toString(f.enc.Hex),a===r.toLowerCase())}function xe(e,r){return oe(e).toLowerCase()===r.toLowerCase()}const z=["md5crypt","sha256crypt","sha512crypt","ntlm","md5","sha1","sha256","sha512","bcrypt","netntlmv2","hmac-md5","hmac-sha1","hmac-sha256","hmac-sha512","mysql323","jwt"];exports.availableHashTypes=z;exports.getPossibleHashTypes=ve;exports.isValidHash=Q;exports.measureSpeed=se;exports.verifyHash=X;
